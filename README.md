# sctrld
Netflow v5 Collector

## Описание sctrld ## 

 приём Netflow v5 обсчёт заданных IP и выполнение команд при достижении лимита
 
## параметры файла настроек sctrld.config ##
```
{
  "NetflowAdress":"0.0.0.0:2055",
  "NetflowBufferSize":212992,
  "WebPort":"8080",
  "CmdDown":"speed-down",
  "CmdUp":"speed-up"
}
```
Настройка | Описание
--- | --- 
NetflowAdress  | ip и порт на которм слушать netflow. Пример: "0.0.0.0:2055"
NetflowBufferSize | Размер буфера пакетов netflow
WebPort | Порт на котором работает WEB сервер. Пример: "8080"
CmdDown | команда при достижении лимита. Должна принимать один параметр: IP адрес
CmdUp | команда при увеличении лимита. Должна принимать один параметр: IP адрес

## описание API ##
Запрос   | Описание | Пример   | Ответ
-------- | -------- | -------- | --------
v1/set/  | Добавить IP для обсчета и установит лимит трафика | http://localhost:8080/v1/set/?ip=172.16.0.1&limit=200&offstart=1&offstop=2 | {"ip": "172.16.0.1", "stat": 0, "limit": 200, "offstart": 1, "offstop": 2}
v1/add/ | Увеличить лимит для IP адреса на значение | http://localhost:8080/v1/add/?ip=172.16.0.1&limit=100 | {"ip": "172.16.0.1", "limit_add": 100}
v1/get/ | Получить статистику по IP адресу | http://localhost:8080/v1/get/?ip=172.16.0.1 | {"ip": "172.16.0.1", "stat": 0, "limit": 300, "offstart": 1, "offstop": 2}
runtime/ | Получить статистику по приложению. | http://localhost:8080/runtime/  | {"Memheap": 917504, "Memidle": 393216, "Meminuse": 524288, "goroutines": 7, "NextGC:": 4194304, "PauseTotalNs": 0}

Параметры | Описание | Пример
-------- | --------  | --------
ip | ip адрес | 172.16.0.2
limit | лимит трафика для ip адреса | 1000 - 1000 byte
offstart | час с которого не считать трафик | 1, значит трафик в 1.00 часов посчитан не будет
offstop | час до которого не считать тарфик | 2, значит трафик в 2.00 часов будет посчитан 
   

